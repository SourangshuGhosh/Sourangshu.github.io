# Perfectly Matched Layer

![](https://raw.githubusercontent.com/SourangshuGhosh/SourangshuGhosh.github.io/master/Blogs/Schematic-of-perfectly-matched-layer.png)

A  **perfectly matched layer**  ( **PML** ) is an artificial absorbing layer for wave equations, commonly used to truncate computational regions in numerical methods to simulate problems with open boundaries, especially in the FDTD and FE methods. The key property of a PML that distinguishes it from an ordinary absorbing material is that it is designed so that waves incident upon the PML from a non-PML medium do not reflect at the interface—this property allows the PML to strongly absorb outgoing waves from the interior of a computational region without reflecting them back into the interior.

PML was originally formulated by Berenger in 1994 for use with Maxwell&#39;s equations, and since that time there have been several related reformulations of PML for both Maxwell&#39;s equations and for other wave-type equations, such as elastodynamics, the linearized Euler equations, Helmholtz equations, and poroelasticity. Berenger&#39;s original formulation is called a  **split-field PML** , because it splits the electromagnetic fields into two unphysical fields in the PML region. A later formulation that has become more popular because of its simplicity and efficiency is called  **uniaxial PML**  or  **UPML** ,in which the PML is described as an artificial anisotropic absorbing material. Although both Berenger&#39;s formulation and UPML were initially derived by manually constructing the conditions under which incident plane waves do not reflect from the PML interface from a homogeneous medium, _both_ formulations were later shown to be equivalent to a much more elegant and general approach:  **stretched-coordinate PML**. In particular, PMLs were shown to correspond to a coordinate transformation in which one (or more) coordinates are mapped to complex numbers; more technically, this is actually an analytic continuation of the wave equation into complex coordinates, replacing propagating (oscillating) waves by exponentially decaying waves. This viewpoint allows PMLs to be derived for inhomogeneous media such as waveguides, as well as for other coordinate systems and wave equations.

The perfectly matched layer (PML) is generally considered the state-of-the-art for the termination
of FDTD grids. There are some situations where specially designed ABC’s can outperform a PML,
but this is very much the exception rather than the rule. The theory behind a PML is typically pertinent to the continuous world. In the continuous world the PML should indeed work “perfectly” (as its name implies) for all incident angles and for all frequencies. However, when a PML is implemented in the discretized world of FDTD, there are always some imperfections (i.e., reflections) present.
There are several different PML formulations. However, all PML’s essentially act as a lossy material. The lossy material, or lossy layer, is used to absorb the fields traveling away from the interior of the grid. The PML is anisotropic and constructed in such a way that there is no loss in the direction tangential to the interface between the lossless region and the PML (actually there can be loss in the non-PML region too, but we will ignore that fact for the moment). However, in the PML there is always loss in the direction normal to the interface. The PML was originally proposed by J.-P. Berenger in 1994. In that original work he split each field component into two separate parts. The actual field components were the sum of these two parts but by splitting the field Berenger could create an (non-physical) anisotropic medium with the necessary phase velocity and conductivity to eliminate reflections at an interface between a PML and non-PML region. Since Berenger first paper, others have described PML’s using different approaches such as the complex coordinate-stretching technique put forward by Chew and Weedon, also in 1994. Arguably the best PML formulation today is the Convolutional-PML (CPML). CPML constructs the PML from an anisotropic, dispersive material. CPML does not require the fields to be
split and can be implemented in a relatively straightforward manner.

## Limitations of perfectly matched layers

PML is widely used and has become the absorbing boundary technique of choice in much of computational electromagnetism. Although it works well in most cases, there are a few important cases in which it breaks down, suffering from unavoidable reflections or even exponential growth.

One caveat with perfectly matched layers is that they are only reflectionless for the _exact_, continuous wave equation. Once the wave equation is discretized for simulation on a computer, some small numerical reflections appear (which vanish with increasing resolution). For this reason, the PML absorption coefficient σ is typically turned on gradually from zero (e.g. quadratically) over a short distance on the scale of the wavelength of the wave. In general, any absorber, whether PML or not, is reflectionless in the limit where it turns on sufficiently gradually (and the absorbing layer becomes thicker), but in a discretized system the benefit of PML is to reduce the finite-thickness &quot;transition&quot; reflection by many orders of magnitude compared to a simple isotropic absorption coefficient.

In certain materials, there are &quot;backward-wave&quot; solutions in which group are opposite to one another. This occurs in &quot;left-handed&quot; negative index metamaterials for electromagnetism and also for acoustic waves in certain solid materials, and in these cases the standard PML formulation is unstable: it leads to exponential growth rather than decay, simply because the sign of _k_ is flipped in the analysis above. Fortunately, there is a simple solution in a left-handed medium (for which all waves are backwards): merely flip the sign of σ. A complication, however, is that physical left-handed materials are dispersive ): they are only left-handed within a certain frequency range, and therefore the σ coefficient must be made frequency-dependent. Unfortunately, even without exotic materials, one can design certain waveguiding structures (such as a hollow metal tube with a high-index cylinder in its center) that exhibit _both_ backwards- and forwards-wave solutions at the same frequency, such that any sign choice for σ will lead to exponential growth, and in such cases PML appears to be irrecoverably unstable.

Another important limitation of PML is that it requires that the medium be invariant in the direction orthogonal to the boundary, in order to support the analytic continuation of the solution to complex coordinates (the complex &quot;coordinate stretching&quot;). As a consequence, the PML approach is no longer valid (no longer reflectionless at infinite resolution) in the case of periodic media (e.g. photonic crystals or phononic crystals) or even simply a waveguide that enters the boundary at an oblique angle.
